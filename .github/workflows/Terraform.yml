name: 'Terraform'

on:
  push:
    branches:
    - main

jobs:
  terraform:
    name: 'Terraform'
    # env:
    #   ARM_CLIENT_ID: ${{ secrets.AZURE_AD_CLIENT_ID }}
    #   ARM_CLIENT_SECRET: ${{ secrets.AZURE_AD_CLIENT_SECRET }}
    #   ARM_SUBSCRIPTION_ID: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
    #   ARM_TENANT_ID: ${{ secrets.AZURE_AD_TENANT_ID }}
    runs-on: ubuntu-latest
    environment: production

    # Use the Bash shell regardless whether the GitHub Actions runner is ubuntu-latest, macos-latest, or windows-latest
    # defaults:
    #   run:
    #     shell: bash

    steps:

    - name: Checkout
      uses: actions/checkout@v3

    - name: Terraform Install
      run: |
        curl -SL https://releases.hashicorp.com/terraform/1.3.5/terraform_1.3.5_linux_amd64.zip --output terraform.zip
        unzip "terraform.zip"
        mv terraform /usr/local/bin
        terraform version
        rm terraform.zip

# - name: Setup Terraform
#   uses: hashicorp/setup-terraform@v2
#   with:
#     terraform_version: 1.1.0

# - name: Terraform Format
#   id: fmt
#   run: terraform fmt -check

# - name: Terraform Init
#   id: init
#   run: terraform init

# - name: Terraform Validate
#   id: validate
#   run: terraform validate -no-color

# - name: Terraform Plan
#   id: plan
#   run: terraform plan -no-color -input=false
#   continue-on-error: true

# - name: Terraform Plan Status
#   if: steps.plan.outcome == 'failure'
#   run: exit 1

# - name: Terraform Apply
#   if: github.ref == 'refs/heads/main'
#   run: terraform apply -auto-approve -input=false
